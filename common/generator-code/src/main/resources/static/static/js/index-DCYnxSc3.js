var e=(e,a,l)=>new Promise(((t,r)=>{var n=e=>{try{u(l.next(e))}catch(a){r(a)}},s=e=>{try{u(l.throw(e))}catch(a){r(a)}},u=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,s);u((l=l.apply(e,a)).next())}));import{b as a,q as l,x as t,g as r,z as n,A as s,s as u,h as o,o as i,i as p,v as m,B as d,u as c,C as g,c as b,D as v,w as f,E as h,G as y,H as _,I as N,J as k,F as q,K as x,L as w,M,O as U,P,Q as A,y as D,R as S,t as j,p as T,S as $,U as C,a as F}from"./vendor-B_wa1CoW.js";import{u as W,s as E}from"./table-1NFVR9mO.js";const I=[{title:"序号",key:"no",titleAlign:"center",align:"center",render:(e,a)=>a+1},{title:"列名称",key:"columnName",titleAlign:"center",align:"center",render:e=>a(l,{type:"primary"},{default:()=>[e.columnName]})},{title:"字段名称",key:"fieldName",titleAlign:"center",align:"center",render:e=>a(l,null,{default:()=>[e.fieldName]})},{title:"数据库字段类型",key:"jdbcType",titleAlign:"center",align:"center",render:e=>a(l,null,{default:()=>[e.jdbcType]})},{title:"Java类型",key:"javaType",titleAlign:"center",align:"center",render:e=>a(l,{type:"warning"},{default:()=>[e.javaType]})},{title:"是否为主键",key:"isPrimaryKey",titleAlign:"center",align:"center",render:e=>e.isPrimaryKey?a(l,{type:"error"},{default:()=>[t("是")]}):a(l,{type:"success"},{default:()=>[t("否")]})},{title:"字段注释",key:"comment",titleAlign:"center",align:"center",render:e=>a(l,{type:"info"},{default:()=>[e.comment]})}],z=r({__name:"index",setup(a){const l=n(),t=W(),r=s([]),d=()=>e(this,null,(function*(){const e=l.query.tableName;r.value=yield t.getColumnInfo(e)}));return u((()=>{d()})),(e,a)=>(i(),o(p(m),{bordered:!0,columns:p(I),data:r.value},null,8,["columns","data"]))}}),H=d("vmsStore",{state:()=>({generators:[]}),getters:{},actions:{generator(a){return e(this,null,(function*(){const e=yield(e=>E({url:"/vms/generator",method:"post",data:e}))(a);200!==e.code&&window.$message.error(e.message),this.generators=e.data,window.$message.success(`生成成功，共 ${this.generators.length} 数据`)}))}}}),K=[{name:"controller",label:"controller"},{name:"mapper",label:"mapper"},{name:"resourceMapper",label:"resourceMapper"},{name:"service",label:"service"},{name:"serviceImpl",label:"serviceImpl"}],R=[{name:"api",label:"api"},{name:"columns",label:"columns"},{name:"dialog",label:"dialog"},{name:"hook",label:"hook"},{name:"index",label:"index"},{name:"store",label:"store"},{name:"labels",label:"labels"}],B={author:{required:!0,trigger:["blur","change","input"],message:"作者不能为空"},packageName:{required:!0,trigger:["blur","change","input"],message:"包名不能为空"},requestMapping:{required:!0,trigger:["blur","change","input"],message:"请求路径不能为空"},className:{required:!0,trigger:["blur","change","input"],message:"类名不能为空"},tableName:{required:!0,trigger:["blur","change","input"],message:"表名不能为空"},simpleDateFormat:{required:!0,trigger:["blur","change","input"],message:"日期格式不能为空"}},J=r({__name:"index",setup(l){const r=n(),m=H(),d=c(),j=s(),T=g({generatorServer:[],generatorWeb:[]}),$=g({author:"Bunny",packageName:"cn.bunny.services",requestMapping:"/api",className:"",tableName:"",simpleDateFormat:"yyyy-MM-dd HH:mm:ss",tablePrefixes:"t_,sys_,qrtz_,log_",path:[]}),C=a=>{var l;a.preventDefault(),null==(l=j.value)||l.validate((a=>e(this,null,(function*(){if(a)a.forEach((e=>{e.forEach((e=>{d.error(`${e.message}->${e.field}`)}))}));else{const e=T.generatorWeb,a=T.generatorServer.map((e=>`server/${e}`)),l=e.map((e=>`web/${e}`));if($.path=[...a,...l],$.path.length<=0)return void d.error("选择要生成的模板");yield m.generator(P($))}}))))};return u((()=>{(()=>{const e=r.query.tableName;$.tableName=e.toString();let a=e;$.tablePrefixes.split(/[,，]/).forEach((e=>{a=a.replace(e,"")})),$.className=a})()})),(e,l)=>(i(),b(q,null,[a(p(v),{ref_key:"formRef",ref:j,"label-width":80,model:$,rules:p(B)},{default:f((()=>[a(p(h),{cols:24,"x-gap":24},{default:f((()=>[a(p(y),{span:8,label:"作者名称",path:"author"},{default:f((()=>[a(p(_),{value:$.author,"onUpdate:value":l[0]||(l[0]=e=>$.author=e),placeholder:"输入姓名"},null,8,["value"])])),_:1}),a(p(y),{span:8,label:"requestMapping名称",path:"requestMapping"},{default:f((()=>[a(p(_),{value:$.requestMapping,"onUpdate:value":l[1]||(l[1]=e=>$.requestMapping=e),placeholder:"输入年龄"},null,8,["value"])])),_:1}),a(p(y),{span:8,label:"表名称",path:"tableName"},{default:f((()=>[a(p(_),{value:$.tableName,"onUpdate:value":l[2]||(l[2]=e=>$.tableName=e),placeholder:"电话号码"},null,8,["value"])])),_:1})])),_:1}),a(p(h),{cols:24,"x-gap":24},{default:f((()=>[a(p(y),{span:8,label:"类名称",path:"className"},{default:f((()=>[a(p(_),{value:$.className,"onUpdate:value":l[3]||(l[3]=e=>$.className=e),placeholder:"电话号码"},null,8,["value"])])),_:1}),a(p(y),{span:8,label:"包名称",path:"packageName"},{default:f((()=>[a(p(_),{value:$.packageName,"onUpdate:value":l[4]||(l[4]=e=>$.packageName=e),placeholder:"电话号码"},null,8,["value"])])),_:1}),a(p(y),{span:8,label:"时间格式",path:"simpleDateFormat"},{default:f((()=>[a(p(_),{value:$.simpleDateFormat,"onUpdate:value":l[5]||(l[5]=e=>$.simpleDateFormat=e),placeholder:"电话号码"},null,8,["value"])])),_:1})])),_:1}),a(p(h),{cols:24,"x-gap":24},{default:f((()=>[a(p(y),{span:8,label:"去除开头前缀",path:"tablePrefixes"},{default:f((()=>[a(p(_),{value:$.tablePrefixes,"onUpdate:value":l[6]||(l[6]=e=>$.tablePrefixes=e),placeholder:"电话号码"},null,8,["value"])])),_:1}),a(p(y),{span:8,label:"生成后端",path:"generatorServer"},{default:f((()=>[a(p(N),{value:T.generatorServer,"onUpdate:value":l[7]||(l[7]=e=>T.generatorServer=e)},{default:f((()=>[a(p(k),null,{default:f((()=>[(i(!0),b(q,null,x(p(K),((e,a)=>(i(),o(p(A),{key:a,value:e.name},{default:f((()=>[t(D(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])])),_:1}),a(p(y),{span:8,label:"生成前端",path:"generatorWeb"},{default:f((()=>[a(p(N),{value:T.generatorWeb,"onUpdate:value":l[8]||(l[8]=e=>T.generatorWeb=e)},{default:f((()=>[a(p(k),null,{default:f((()=>[(i(!0),b(q,null,x(p(R),((e,a)=>(i(),o(p(A),{key:a,value:e.name,"onUpdate:value":a=>e.name=a},{default:f((()=>[t(D(e.label),1)])),_:2},1032,["value","onUpdate:value"])))),128))])),_:1})])),_:1},8,["value"])])),_:1})])),_:1}),a(p(w),null,{default:f((()=>[a(p(M),{"attr-type":"button",class:"w-full",type:"primary",onClick:C},{default:f((()=>l[9]||(l[9]=[t(" 开始生成 ")]))),_:1})])),_:1})])),_:1},8,["model","rules"]),a(p(U),null,{default:f((()=>[(i(!0),b(q,null,x(p(m).generators,((e,l)=>(i(),o(p(S),{key:l,name:e.path,title:e.path},{default:f((()=>[a(p(_),{autosize:{minRows:3},placeholder:e.comment,value:e.code,type:"textarea"},null,8,["placeholder","value"])])),_:2},1032,["name","title"])))),128))])),_:1})],64))}}),O=r({__name:"index",setup(l){const t=T(),r=n(),s=W(),m=g({tableName:"",comment:"",tableCat:"",tableType:""}),d=()=>e(this,null,(function*(){const e=r.query.tableName,a=yield s.getTableMetaData(e);Object.assign(m,a)}));return u((()=>{d()})),(e,l)=>(i(),o(p(j),null,{header:f((()=>[a(p(j),{title:"数据库信息"},{default:f((()=>[F("span",{class:"color-blue",onClick:l[0]||(l[0]=e=>p(t).push("/"))},"回到首页"),F("ul",null,[F("li",null,"表名："+D(p(r).query.tableName),1),F("li",null,"表注释："+D(m.comment),1),F("li",null,"数据库名："+D(m.tableCat),1),F("li",null,"类型："+D(m.tableType),1)])])),_:1})])),default:f((()=>[a(p(C),{animated:"",type:"line"},{default:f((()=>[a(p($),{name:"generator-code",tab:"生成"},{default:f((()=>[a(J)])),_:1}),a(p($),{name:"columns-info",tab:"列字段"},{default:f((()=>[a(z)])),_:1})])),_:1})])),_:1}))}});export{O as default};
